import{al as e,z as t,A as o,R as r,ax as a,r as n,ay as s,az as i,au as c,aA as u}from"./vue-vendor-e938fa8e.js";import{a as l}from"./utils-926e52e0.js";import{E as d,i as m}from"./element-plus-9e07dff4.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const p=(e,t)=>{const o=e.__vccOpts||e;for(const[r,a]of t)o[r]=a;return o},v={class:"app-container"};const h=p({},[["render",function(a,n){const s=e("router-view");return t(),o("div",v,[r(s)])}],["__scopeId","data-v-4243d3c9"]]),f={},_=function(e,t,o){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in f)return;f[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(!!o)for(let o=r.length-1;o>=0;o--){const a=r[o];if(a.href===e&&(!t||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise((t,o)=>{n.addEventListener("load",t),n.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})},g=()=>{if({}.VITE_SOCKET_URL)return{}.VITE_SOCKET_URL;const e=window.location.hostname;return`${window.location.protocol}//${e}:5000`},w=l.create({baseURL:(()=>{if({}.VITE_API_BASE_URL)return{}.VITE_API_BASE_URL;const e=window.location.hostname;return`${window.location.protocol}//${e}:5000/api`})(),timeout:3e4});w.interceptors.request.use(e=>("true"===localStorage.getItem("dev_mode")&&(e.headers["X-Dev-Mode"]="true"),e),e=>Promise.reject(e)),w.interceptors.response.use(e=>e,e=>(d.error(e.message||"请求失败"),Promise.reject(e)));const y=a("auth",()=>{const e=n(!1),t=n(null),o=n(!1),r=n(!1);return{isAuthenticated:e,user:t,devMode:o,isLoggingOut:r,checkAuth:async function(){if(r.value)return!1;if(await async function(){const r=new URLSearchParams(window.location.search).get("dev_key");if(r)try{const a=await w.post("/auth/dev-mode",{key:r});if(a.data.success){o.value=!0,e.value=!0,t.value=a.data.user,localStorage.setItem("dev_mode","true");const r=new URL(window.location);return r.searchParams.delete("dev_key"),window.history.replaceState({},"",r),!0}}catch(a){}return"true"===localStorage.getItem("dev_mode")&&(o.value=!0,e.value=!0,t.value={email:"dev@local",expire_date:"2099-12-31"},!0)}())return!0;try{const o=await w.get("/auth/status");return e.value=o.data.authenticated,t.value=o.data.user,e.value}catch(a){return e.value=!1,t.value=null,!1}},login:async function(o,r){const a=await w.post("/auth/login",{email:o,password:r});return a.data.success?(e.value=!0,t.value=a.data.user,{success:!0}):{success:!1,message:a.data.message}},logout:async function(){if(r.value=!0,o.value)localStorage.removeItem("dev_mode"),o.value=!1;else try{await w.post("/auth/logout")}catch(a){}e.value=!1,t.value=null,setTimeout(()=>{r.value=!1},100)}}}),E=[{path:"/login",name:"Login",component:()=>_(()=>import("./Login-3e86c6d2.js"),["js/Login-3e86c6d2.js","js/vue-vendor-e938fa8e.js","js/element-plus-9e07dff4.js","js/utils-926e52e0.js","css/Login-c322ef37.css"]),meta:{title:"登录"}},{path:"/",component:()=>_(()=>import("./Layout-961064de.js"),["js/Layout-961064de.js","js/vue-vendor-e938fa8e.js","js/element-plus-9e07dff4.js","js/utils-926e52e0.js","css/Layout-929b5027.css"]),redirect:"/overview",meta:{requiresAuth:!0},children:[{path:"overview",name:"Overview",component:()=>_(()=>import("./Overview-fae3388c.js"),["js/Overview-fae3388c.js","js/vue-vendor-e938fa8e.js","js/element-plus-9e07dff4.js","js/echarts-e73e11b1.js","js/utils-926e52e0.js","css/Overview-8c732218.css"]),meta:{title:"总览"}},{path:"strategy",name:"Strategy",component:()=>_(()=>import("./StrategyConfig-99a9b497.js"),["js/StrategyConfig-99a9b497.js","js/vue-vendor-e938fa8e.js","js/element-plus-9e07dff4.js","js/codemirror-08f4cc02.js","js/utils-926e52e0.js","css/StrategyConfig-dd4c2c5e.css"]),meta:{title:"策略配置"}},{path:"logs",name:"Logs",component:()=>_(()=>import("./LogView-87ddcbf8.js"),["js/LogView-87ddcbf8.js","js/element-plus-9e07dff4.js","js/vue-vendor-e938fa8e.js","js/utils-926e52e0.js","css/LogView-080d1ce3.css"]),meta:{title:"运行日志"}}]}],L=s({history:i(),routes:E});L.beforeEach(async(e,t,o)=>{const r=y();r.isAuthenticated||await r.checkAuth(),!e.matched.some(e=>e.meta.requiresAuth)||r.isAuthenticated?"/login"===e.path&&r.isAuthenticated?o("/overview"):o():o("/login")});const A=c(h),I=u();document.documentElement.classList.add("dark"),A.use(I),A.use(L),A.use(m),A.mount("#app");export{p as _,w as a,g,y as u};
